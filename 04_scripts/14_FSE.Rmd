---
title: "FSS."
output:
  html_document: def
---
Loading the required library

Here is a plot of the ground state energy for r = 1

```{r echo = FALSE}
x <- spatial_extent_array

value <- rep(NA, length(x))
bsamples <- matrix(NA, nrow = boot.R, ncol = length(x))
dvalue <- rep(NA, length(x))

for(i in seq_along(x)){
  value[i] <- VLst[[i]][[1]][1]
  bsamples[,i] <- VLst[[i]][[2]][,1]
  dvalue[i] <- VLst[[i]][[3]][1]
}

pdf(paste0(plots_SS, "E0_r2F_b", inv_coupling,"_OBC", extra,"/E0_1.pdf"))
plotwitherror(x, value, dvalue, main = paste0("E_0 for r = ", rr[1], " beta = ", inv_coupling), xlab = "L/a", ylab = "E_0")
dev.off()
print(apply(bsamples, 2, sd))
print(dvalue)
```

Here is a plot of the ground state energy for r = sqrt(2)

```{r echo = FALSE}
x <- spatial_extent_array

value <- rep(NA, length(x))
bsamples <- matrix(NA, nrow = boot.R, ncol = length(x))
dvalue <- rep(NA, length(x))

for(i in seq_along(x)){
  value[i] <- VLst[[i]][[1]][2]
  bsamples[,i] <- VLst[[i]][[2]][,2]
  dvalue[i] <- VLst[[i]][[3]][2]
}

pdf(paste0(plots_SS, "E0_r2F_b", inv_coupling,"_OBC", extra,"/E0_sqrt2.pdf"))
plotwitherror(x, value, dvalue, main = paste0("E_0 for r = ", r_i[2], " beta = ", inv_coupling), xlab = "L/a", ylab = "E_0")
dev.off()
```

Plot of the ground state energy for r = 2

```{r echo = FALSE}
x <- spatial_extent_array

value <- rep(NA, length(x))
bsamples <- matrix(NA, nrow = boot.R, ncol = length(x))
dvalue <- rep(NA, length(x))

for(i in seq_along(x)){
  value[i] <- VLst[[i]][[1]][3]
  bsamples[,i] <- VLst[[i]][[2]][,3]
  dvalue[i] <- VLst[[i]][[3]][3]
}

pdf(paste0(plots_SS, "E0_r2F_b", inv_coupling,"_OBC", extra,"/E0_2.pdf"))
plotwitherror(x, value, dvalue, main = paste0("E_0 for r = ", r_i[3], " beta = ", inv_coupling), xlab = "L/a", ylab = "E_0")
dev.off()
```
Plot of the ground state energy for r = sqrt(5)

```{r echo = FALSE}
x <- spatial_extent_array

value <- rep(NA, length(x))
bsamples <- matrix(NA, nrow = boot.R, ncol = length(x))
dvalue <- rep(NA, length(x))

for(i in seq_along(x)){
  value[i] <- VLst[[i]][[1]][4]
  bsamples[,i] <- VLst[[i]][[2]][,4]
  dvalue[i] <- VLst[[i]][[3]][4]
}

pdf(paste0(plots_SS, "E0_r2F_b", inv_coupling,"_OBC", extra,"/E0_sqrt5.pdf"))
plotwitherror(x, value, dvalue, main = paste0("E_0 for r = ", r_i[4], " beta = ", inv_coupling), xlab = "L/a", ylab = "E_0")
dev.off()
```

Here is a plot of the running coupling r^2F(r,g) for r = 1

```{r echo = FALSE}
x <- spatial_extent_array

value <- rep(NA, length(x))
bsamples <- matrix(NA, nrow = boot.R, ncol = length(x))

for(i in seq_along(x)){
  value[i] <- as.numeric(g1Lst[[i]][1])
  bsamples[,i] <- unlist(g1Lst[[i]][2])
}

value <- unlist(value)
bsamples <- as.matrix(bsamples, nrow = boot.R, ncol = length(x))

pdf(paste0(plots_SS, "E0_r2F_b", inv_coupling,"_OBC", extra,"/r2F_1.pdf"))
plotwitherror(x, value, apply(bsamples, 2, sd), main = paste0("g(r,beta) for r = ", r_i[1], " beta = ", inv_coupling), xlab = "L/a", ylab = "g(r1,beta)")
dev.off()
```

Here is a plot of the running coupling r^2F(r,g) for r = sqrt2

```{r echo = FALSE}
x <- spatial_extent_array

value <- rep(NA, length(x))

bsamples <- matrix(NA, nrow = boot.R, ncol = length(x))

for(i in seq_along(x)){
  value[i] <- as.numeric(g2Lst[[i]][1])
  bsamples[,i] <- unlist(g2Lst[[i]][2])
}

value <- unlist(value)
bsamples <- as.matrix(bsamples, nrow = boot.R, ncol = length(x))

pdf(paste0(plots_SS, "E0_r2F_b", inv_coupling,"_OBC", extra,"/r2F_sqrt2.pdf"))
plotwitherror(x, value, apply(bsamples, 2, sd), main = paste0("g(r,beta) for r = ", r_i[2], " beta = ", inv_coupling), xlab = "L/a", ylab = "g(r2,beta)")
dev.off()
```

plot for E0(r) at fixed L

```{r}
x <- c(3, 4, 5)

value1 <- rep(NA, length(x))
value2 <- rep(NA, length(x))
value3 <- rep(NA, length(x))

bsamples1 <- matrix(NA, nrow = boot.R, ncol = length(x))
bsamples2 <- matrix(NA, nrow = boot.R, ncol = length(x))
bsamples3 <- matrix(NA, nrow = boot.R, ncol = length(x))

for(i in seq_along(x)){
  value1[i] <- VLst[[i]][[1]][1]
  bsamples1[,i] <- VLst[[i]][[2]][,1]
  value2[i] <- VLst[[i]][[1]][2]
  bsamples2[,i] <- VLst[[i]][[2]][,2]
  value3[i] <- VLst[[i]][[1]][3]
  bsamples3[,i] <- VLst[[i]][[2]][,3]
}

pdf(paste0(plots_SS, "E0_r2F_b", inv_coupling,"_OBC", extra,"/E0_vs_r.pdf"))
  plotwitherror(x, value1, apply(bsamples1, 2, sd), col = "red", ylim = c(0.45, 0.95), ylab = "E_0", xlab = "L/a", main = "E_0(L) for different distances r", cex = 1.2)
  plotwitherror(x, value2, apply(bsamples2, 2, sd), col = "blue", rep = TRUE,  cex = 1.2)
  plotwitherror(x, value3, apply(bsamples3, 2, sd), col = "green", rep = TRUE,  cex = 1.2)
  legend(x = "topright", legend = c("r=1", "r=sqrt(2)", "r=sqrt(5)"), pch = 1, cex = 1.2, col = c("red", "blue", "green"))
dev.off()
```

Plotting r2F vs r at fixed L

```{r}
x <- c(3, 4, 5)

value1 <- rep(NA, length(x))
value2 <- rep(NA, length(x))

bsamples1 <- matrix(NA, nrow = boot.R, ncol = length(x))
bsamples2 <- matrix(NA, nrow = boot.R, ncol = length(x))

for(i in seq_along(x)){
  value1[i] <- as.numeric(g1Lst[[i]][1])
  bsamples1[,i] <- unlist(g1Lst[[i]][2])
  value2[i] <- as.numeric(g2Lst[[i]][1])
  bsamples2[,i] <- unlist(g2Lst[[i]][2])
}

pdf(paste0(plots_SS, "E0_r2F_b", inv_coupling,"_OBC", extra,"/r2F_vs_r.pdf"))
  plotwitherror(x, value1, apply(bsamples1, 2, sd), col = "red", ylim = c(0.35, 0.8), main = "g=r^2*dV/dr(L) for different values of r", xlab = "L/a", ylab = "g")
  plotwitherror(x, value2, apply(bsamples2, 2, sd), col = "blue", rep = TRUE)
  legend(x = "topright", legend = c("r=1", "r=sqrt(2)"), pch = 1, cex = 1.2, col = c("red", "blue"))
dev.off()
```
